patch:
  schema:
    schema_id: terra_pinyin
    name: "åœ°çƒæ‹¼éŸ³-è–„è·å®šåˆ¶"
    version: '24.02.15'
    author:
      - ä½›æŒ¯ <chen.sst@gmail.com>
      - mintimate < @Mintimate|https://www.mintimate.cn >
    description: |
      ã€Œæ¼¢èªæ‹¼éŸ³ã€ï¼Œä»¥ç¬¦è™ŸæŒ‰éµ - / < \ è¼¸å…¥å››è²
      æ‹¼éŸ³ç¢¼è¡¨æ ¹æ“š CC-CEDICT æ”¹ç·¨
    dependencies:
      - wubi98_mint
      - stroke
      - radical_pinyin # å‚è€ƒ https://github.com/mirtlecn/rime-radical-pinyin
      - melt_eng # è‹±æ–‡æ–¹æ¡ˆ
  
  switches:
    - name: ascii_mode
      reset: 0
      states: [ ä¸­æ–‡, è‹±æ–‡ ]
    - name: emoji_suggestion
      reset: 1
      states: [ "ğŸ˜£ï¸","ğŸ˜ï¸"]
    - name: full_shape
      states: [ åŠè§’, å…¨è§’ ]
    - name: transcription
      reset: 0
      states: [ ç®€ä½“ , ç¹ä½“ ]
    - name: ascii_punct
      states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]

  key_binder:
    bindings:
      - {accept: "Control+Shift+E", toggle: emoji_suggestion, when: always}
      - {accept: "Control+Shift+1", toggle: transcription, when: has_menu}
      - {accept: bracketleft, send: Page_Up, when: paging}      # ä½¿ç”¨`[`è¿›è¡Œå‘ä¸Šç¿»é¡µï¼ˆç¬¬ä¸€é¡µæ—¶å€™æ— æ•ˆï¼‰
      - {accept: bracketright, send: Page_Down, when: has_menu} # ä½¿ç”¨`]`è¿›è¡Œå‘ä¸‹ç¿»é¡µ
      - {accept: minus, send: Page_Up, when: paging}     # ä½¿ç”¨`-`è¿›è¡Œå‘ä¸Šç¿»é¡µï¼ˆç¬¬ä¸€é¡µæ—¶å€™æ— æ•ˆï¼‰
      - {accept: equal, send: Page_Down, when: has_menu} # ä½¿ç”¨`=`è¿›è¡Œå‘ä¸‹ç¿»é¡µ
  
  engine:
    processors:
      - lua_processor@select_character      # ä»¥è¯å®šå­—
      - lua_processor@*code_length_limit    # ä½¿ç”¨Luaé™åˆ¶è¾“å…¥å†…å®¹çš„æœ€å¤§é•¿åº¦(é˜²æ­¢è¿‡é•¿è€Œå¡é¡¿)
      - ascii_composer
      - recognizer
      - key_binder
      - speller
      - punctuator
      - selector
      - navigator
      - express_editor
    segmentors:
      - ascii_segmentor
      - matcher
      - affix_segmentor@wubi98_mint
      - affix_segmentor@radical_reverse_lookup
      - affix_segmentor@stroke
      - abc_segmentor
      - punct_segmentor
      - fallback_segmentor
    translators:
      - lua_translator@date_translator           # æ—¥æœŸ Lua
      - lua_translator@time_translator           # æ—¶é—´ Lua
      - lua_translator@week_translator           # æ˜ŸæœŸ Lua
      - lua_translator@number_translator         # é‡‘é¢å¤§å°å†™ Lua
      - lua_translator@Chinese_lunar_calendar    # å†œå† Lua
      - punct_translator
      - table_translator@custom_phrase
      - table_translator@melt_eng           # è‹±æ–‡è¾“å…¥ï¼ˆä½œä¸ºå­ç¿»è¯‘å™¨ï¼Œä¼˜å…ˆçº§éœ€è¦æ¯”åŸç”Ÿçš„ä½ï¼‰
      - reverse_lookup_translator@wubi98_mint
      - reverse_lookup_translator@radical_reverse_lookup
      - reverse_lookup_translator@stroke
      - script_translator
    filters:
      - lua_filter@autocap_filter           # è‹±æ–‡è‡ªåŠ¨å¤§å†™
      - simplifier@emoji_suggestion         # Emoji OpenCC
      - simplifier@transcription_cc         # ç¹ä½“&ç®€ä½“ OpenCC
      - lua_filter@reduce_english_filter    # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
      - uniquifier                          # å»é‡


  # ç®€ç¹åˆ‡æ¢
  transcription_cc:
    option_name: transcription
    opencc_config: s2t.json             # s2t.json | s2hk.json | s2tw.json | s2twp.json
    tips: none                          # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
    excluded_types: [ reverse_lookup ]  # ä¸è½¬æ¢åæŸ¥ï¼ˆä¸¤åˆ†æ‹¼å­—ï¼‰çš„å†…å®¹

  # Emojiæ¨¡å—
  emoji_suggestion:
    opencc_config: emoji.json
    option_name: emoji_suggestion
    tips: all
    inherit_comment: false

  # æœ€å¤§è¾“å…¥é•¿åº¦
  code_length_limit: 25

  # Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®ã€‚
  # è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
  # æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
  # é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
  reduce_english_filter:
      mode: all  # all | none | custom | ã€ç•™ç™½ã€
      idx: 2        # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
      # è‡ªå®šä¹‰çš„å•è¯åˆ—è¡¨ï¼Œç¤ºä¾‹åˆ—è¡¨æ²¡æœ‰é™ä½éƒ¨åˆ†å¸¸ç”¨å•è¯ï¼Œå¦‚ and cat mail Mac but bad shit â€¦â€¦
      words: [aid, ann,
      bail, bait, bam, band, bans, bat, bay, bend, bent, benz, bib, bid, bien, biz, boc, bop, bos, bud, buf,
      cab, cad, cain, cam, cans, cap, cas, cef, chad, chan, chap, chef, cher, chew, chic, chin, chip, chit, coup, cum, cunt, cur,
      dab, dag, dal, dam, dent, dew, dial, diet, dim, din, dip, dis, dit, doug, dub, dug, dunn,
      fab, fax, fob, fog, foul, fur,
      gag, gail, gain, gal, gam, gaol, ged, gel, ger, guam, gus, gut,
      hail, ham, hank, hans, hat, hay, heil, heir, hem, hep, hud, hum, hung, hunk, hut,
      jim, jug,
      kat,
      lab, lad, lag, laid, lam, laos, lap, lat, lax, lay, led, leg, lex, liam, lib, lid, lied, lien, lies, linn, lip, lit, liz, lob, lug, lund, lung, lux,
      mag, maid, mann, mar, mat, med, mel, mend, mens, ment, mil, mins, mint, mob, moc, mop, mos, mot, mud, mug, mum, nail,
      nap, nat, nay, neil, nib, nip, noun, nous, nun, nut,
      pac, paid, pail, pain, pair, pak, pal, pam, pans, pant, pap, par, pat, paw, pax, pens, pic, pier, pies, pins, pint, pit, pix, pod, pop, pos, pot, pour, pow, pub,
      rand, rant, rent, rep, res, ret, rex, rib, rid, rig, rim, rub, rug, rum, runc, runs,
      sac, sail, sal, sam, sans, sap, saw, sax, sew, sham, shaw, shin, sig, sin, sip, sis, suit, sung, suns, sup, sur, sus,
      tad, tail, taj, tar, tax, tec, ted, tel, ter, tex, tic, tied, tier, ties, tim, tin, tit, tour, tout, tum, me, 
      wag, wand, womens, wap, wax, weir, won,
      yan, yen]
  
  speller:
    alphabet: 'zyxwvutsrqponmlkjihgfedcba-;/<,>\'
    initials: zyxwvutsrqponmlkjihgfedcba
    delimiter: " '"
    algebra:
      - xform/^r5$/er5/
      - erase/^xx$/
      - derive/^([zcs])h/$1/ # zh, ch, sh => z, c, s
      - derive/^([zcs])([^h])/$1h$2/ # z, c, s => zh, ch, sh
      - derive/([aei])n$/$1ng/ # en => eng, in => ing
      - derive/([aei])ng$/$1n/ # eng => en, ing => in
      - derive/([iu])an$/$lang/ # ian => iang, uan => uang
      - derive/([iu])ang$/$lan/ # iang => ian, uang => uan
      - derive/([aeiou])ng$/$1gn/        # dagn => dang
      - derive/([dtngkhrzcs])o(u|ng)$/$1o/  # zho => zhong|zhou
      - derive/ong$/on/                  # zhonguo => zhong guo
      - derive/ao$/oa/                   # hoa => hao
      - derive/([iu])a(o|ng?)$/a$1$2/    # tain => tian
      - abbrev/^([a-z]).+$/$1/
      - abbrev/^([zcs]h).+$/$1/
      - derive/^([nl])ve/$1ue/
      - derive/^([jqxy])u/$1v/
      - derive/([dtnlgkhrzcs])un/$1uen/
      - derive/ui/uei/
      - derive/iu/iou/
      - derive/ao/oa/
      - derive/([aeiou])ng/$1gn/
      - derive/([iu])a(o|ng?)/a$1$2/
      - derive/^([a-z]+)[0-5]$/$1/
      - derive/([dtngkhrzcs])o(u|ng)$/$1o/
      - derive/ong$/on/
      - 'erase/^.*5$/'
      - 'xlit 1234 -/<\'
      - 'derive/^(.*)-$/$1;/'
      - 'derive/^(.*)<$/$1,/'
      - 'derive/^(.*)\\$/$1>/'
  
  translator:
    dictionary: terra_pinyin
    initial_quality: 1.2
    spelling_hints: 3  # ï½å­—ä»¥å…§å€™é¸æ¨™è¨»å®Œæ•´å¸¶èª¿æ‹¼éŸ³
    preedit_format:
      - xform/([nl])v/$1Ã¼/
      - xform/([nl])ue/$1Ã¼e/
      - xform/([nl])Ã¼en/$1uen/
      - xform/([jqxy])v/$1u/
      - xform/eh/Ãª/
      - 'xform ([aeiou])(ng?|r)([-;/<,>\\]) $1$3$2'
      - 'xform ([aeo])([iuo])([-;/<,>\\]) $1$3$2'
      - 'xform a[-;] Ä'
      - 'xform a/ Ã¡'
      - 'xform a[<,] Ç'
      - 'xform a[>\\] Ã '
      - 'xform e[-;] Ä“'
      - 'xform e/ Ã©'
      - 'xform e[<,] Ä›'
      - 'xform e[>\\] Ã¨'
      - 'xform o[-;] Å'
      - 'xform o/ Ã³'
      - 'xform o[<,] Ç’'
      - 'xform o[>\\] Ã²'
      - 'xform i[-;] Ä«'
      - 'xform i/ Ã­'
      - 'xform i[<,] Ç'
      - 'xform i[>\\] Ã¬'
      - 'xform u[-;] Å«'
      - 'xform u/ Ãº'
      - 'xform u[<,] Ç”'
      - 'xform u[>\\] Ã¹'
      - 'xform Ã¼[-;] Ç–'
      - 'xform Ã¼/ Ç˜'
      - 'xform Ã¼[<,] Çš'
      - 'xform Ã¼[>\\] Çœ'
    comment_format:
      - xform ([aeiou])(ng?|r)([1234]) $1$3$2
      - xform ([aeo])([iuo])([1234]) $1$3$2
      - xform a1 Ä
      - xform a2 Ã¡
      - xform a3 Ç
      - xform a4 Ã 
      - xform e1 Ä“
      - xform e2 Ã©
      - xform e3 Ä›
      - xform e4 Ã¨
      - xform o1 Å
      - xform o2 Ã³
      - xform o3 Ç’
      - xform o4 Ã²
      - xform i1 Ä«
      - xform i2 Ã­
      - xform i3 Ç
      - xform i4 Ã¬
      - xform u1 Å«
      - xform u2 Ãº
      - xform u3 Ç”
      - xform u4 Ã¹
      - xform v1 Ç–
      - xform v2 Ç˜
      - xform v3 Çš
      - xform v4 Çœ
      - xform/([nljqxy])v/$1Ã¼/
      - xform/eh[0-5]?/Ãª/
      - xform/([a-z]+)[0-5]/$1/
  
  custom_phrase:
    dictionary: ""
    user_dict: custom_phrase
    db_class: stabledb
    enable_completion: false
    enable_sentence: false
    initial_quality: 1

  melt_eng:
    dictionary: melt_eng           # è‹±æ–‡è¯å…¸
    enable_sentence: false         # å…³é—­è‡ªåŠ¨é€ å¥
    enable_completion: false       # å…³é—­è‡ªåŠ¨æç¤º
    initial_quality: 0.8

  wubi98_mint:
    tag: wubi98_mint
    dictionary: wubi98_mint
    enable_user_dict: false
    enable_completion: true
    prefix: "uw"
    suffix: "'"
    tips: ã€”äº”ç¬”ã€•
    comment_format:
      - xform ([aeiou])(ng?|r)([1234]) $1$3$2
      - xform ([aeo])([iuo])([1234]) $1$3$2
      - xform a1 Ä
      - xform a2 Ã¡
      - xform a3 Ç
      - xform a4 Ã 
      - xform e1 Ä“
      - xform e2 Ã©
      - xform e3 Ä›
      - xform e4 Ã¨
      - xform o1 Å
      - xform o2 Ã³
      - xform o3 Ç’
      - xform o4 Ã²
      - xform i1 Ä«
      - xform i2 Ã­
      - xform i3 Ç
      - xform i4 Ã¬
      - xform u1 Å«
      - xform u2 Ãº
      - xform u3 Ç”
      - xform u4 Ã¹
      - xform v1 Ç–
      - xform v2 Ç˜
      - xform v3 Çš
      - xform v4 Çœ
      - xform/([nljqxy])v/$1Ã¼/
      - xform/eh[0-5]?/Ãª/
      - xform/([a-z]+)[0-5]/$1/

  stroke:
    tag: stroke
    dictionary: stroke
    enable_user_dict: false
    prefix: 'ui'
    suffix: "'"
    tips: ã€”ç¬”ç”»ã€•
    preedit_format:
      - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/
    comment_format:
      - xform/([nl])v/$1Ã¼/
      - xform ([aeiou])(ng?|r)([1234]) $1$3$2
      - xform ([aeo])([iuo])([1234]) $1$3$2
      - xform a1 Ä
      - xform a2 Ã¡
      - xform a3 Ç
      - xform a4 Ã 
      - xform e1 Ä“
      - xform e2 Ã©
      - xform e3 Ä›
      - xform e4 Ã¨
      - xform o1 Å
      - xform o2 Ã³
      - xform o3 Ç’
      - xform o4 Ã²
      - xform i1 Ä«
      - xform i2 Ã­
      - xform i3 Ç
      - xform i4 Ã¬
      - xform u1 Å«
      - xform u2 Ãº
      - xform u3 Ç”
      - xform u4 Ã¹
      - xform v1 Ç–
      - xform v2 Ç˜
      - xform v3 Çš
      - xform v4 Çœ
      - xform/([nljqxy])v/$1Ã¼/
      - xform/eh[0-5]?/Ãª/
      - xform/([a-z]+)[0-5]/$1/

  radical_reverse_lookup:
    tag: radical_lookup
    dictionary: radical_pinyin
    enable_completion: true
    prefix: "uu"
    preedit_format:
      - xform/([nljqxy])v/$1Ã¼/
    comment_format:
      - xform/([nljqxy])v/$1Ã¼/
      - xform ([aeiou])(ng?|r)([1234]) $1$3$2
      - xform ([aeo])([iuo])([1234]) $1$3$2
      - xform a1 Ä
      - xform a2 Ã¡
      - xform a3 Ç
      - xform a4 Ã 
      - xform e1 Ä“
      - xform e2 Ã©
      - xform e3 Ä›
      - xform e4 Ã¨
      - xform o1 Å
      - xform o2 Ã³
      - xform o3 Ç’
      - xform o4 Ã²
      - xform i1 Ä«
      - xform i2 Ã­
      - xform i3 Ç
      - xform i4 Ã¬
      - xform u1 Å«
      - xform u2 Ãº
      - xform u3 Ç”
      - xform u4 Ã¹
      - xform v1 Ç–
      - xform v2 Ç˜
      - xform v3 Çš
      - xform v4 Çœ
      - xform/([nljqxy])v/$1Ã¼/
      - xform/eh[0-5]?/Ãª/
      - xform/([a-z]+)[0-5]/$1/
    tips: ã€”æ‹†å­—ã€•


  reverse_lookup:
    tags: [wubi98_mint,stroke,radical_lookup]
    overwrite_comment: false

  
  punctuator:
    import_preset: symbols
    # å®šä¹‰éƒ¨åˆ†åŠè§’å­—ç¬¦
    half_shape:
        "#": "#"
        "*": "*"
        '.' : { commit: ã€‚ }
        "`": "`"
        "~": "~"
        "@": "@"
        "=": "="
        "/": ["/", "Ã·",]
        '\': "ã€"
        "_" : "â”€â”€"
        "'": {pair: ["ã€Œ", "ã€"]}
        "[": ["ã€", "["]
        "]": ["ã€‘", "]"]
        "$": ["Â¥", "$", "â‚¬", "Â£", "Â¢", "Â¤"]
        "<": ["ã€Š", "ã€ˆ", "Â«", "<"]
        ">": ["ã€‹", "ã€‰", "Â»", ">"]
  
  recognizer:
    import_preset: default
    patterns:
      url: "^[a-z]+[.].+$"
      punct: "^/([0-9]0?|[a-z]+)$"
      wubi98_mint: "uw[a-z]*'?$"
      stroke: "ui[a-z]*'?$"
      radical_lookup: "uu[a-z]*'?$"
